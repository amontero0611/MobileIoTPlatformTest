<html>
<meta charset="UTF-8">
<head>
<title>Accelerometer and Watson IoT testing</title>
<meta name="viewport" content="width=device-width,user-scalable=yes" />
<style>
body {
	font-family: helvetica, arial, sans serif;
}
#sphere {
	position: absolute;	
	width: 50px;
	height: 50px;
	border-radius: 50px;
	-webkit-radius: 50px;
	background-color: red;
}
</style>
</head>

<body>
<div id="content">
    <h1>Uso de aceler&oacute;metro con Watson IoT</h1>
    <br>
     <form>
  		<label>Org ID <span style="display:inline-block; width: 99;"></span>:
  			<input type="text" id="organizacion" size=10>
  		</label><br>
		<label>Device Type <span style="display:inline-block; width: 48;"></span>:
  			<input type="text" id="tipoDisp" size=10>
  		</label><br>
		<label>Device ID<span style="display:inline-block; width: 77;"></span>:
  			<input type="text" id="IdDisp" size=10>
  		</label><br>
  		<label>Device Passwd<span style="display:inline-block; width: 27;"></span>:
  			<input type="text" id="passwordDisp" size=10>
  		</label><br>
        <input id="connectButton" type="button" value="Connect" />  			
	 </form>
	<br>
    <div id="sphere"></div>
		<ul>
			<li>Rotaci&oacute;n alpha: <span id="rotationAlpha"></span>&deg;</li>
			<li>Rotaci&oacute;n beta: <span id="rotationBeta"></span>&deg;</li>
			<li>Rotaci&oacute;n gamma: <span id="rotationGamma"></span>&deg;</li>
		</ul>
	</div>

    <p hidden id="isConnected">false</p>
	 
	<script src="sphere.js"></script>
	<script src="app.js"></script>
	<script src="libs/mqttws31-min.js"></script>

	<script>
	var OrgId;
	var userName = 'use-token-auth';
	var password;
	var deviceType;
	var deviceId;
	var port = 8883;
    document.getElementById("connectButton").onclick = function () 
    { 
		orgId = document.getElementById("organizacion").value;
		console.log("Organizacion " + orgId);
		//var deviceType = 'Mobile'
		deviceType = document.getElementById("tipoDisp").value;
		console.log("Tipo Disp " + deviceType);
		//var deviceId = 'GS7'
		deviceId = document.getElementById("IdDisp").value;
		console.log("ID Disp " + deviceId);
		console.log("username " + userName);
		//var password = 'ibm4metoo'		
		password = document.getElementById("passwordDisp").value;
		console.log("password " + password);
		//Your device type and device id
		
		// Standard port for MQTT is 1883, encrypted 8883
		
		if (document.getElementById("isConnected").innerHTML == "false")
		{
		    app.onReady();		    
		    var myPublishInterval = setInterval(myPubMsg, 3000);
        };    
	};
    function myPubMsg() {
    	if (document.getElementById("isConnected").innerHTML == "true") {
    		var rotacionalfa = document.getElementById("rotationAlpha").innerHTML;
			var rotacionbeta = document.getElementById("rotationBeta").innerHTML;
			var rotaciongamma = document.getElementById("rotationGamma").innerHTML;
    		var evt = JSON.stringify({rotalfa: rotacionalfa, rotbeta: rotacionbeta, rotgamma:rotaciongamma})
    		console.log("Enviando evento")
			//send to MQTT publish function
			app.publish(evt)
        };
    };
	</script>

</body>

</html>